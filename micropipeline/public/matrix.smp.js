var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){a!=Array.prototype&&a!=Object.prototype&&(a[b]=c.value)};$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);$jscomp.SYMBOL_PREFIX="jscomp_symbol_";
$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.Symbol=function(){var a=0;return function(b){return $jscomp.SYMBOL_PREFIX+(b||"")+a++}}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.iterator;a||(a=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[a]&&$jscomp.defineProperty(Array.prototype,a,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};$jscomp.arrayIterator=function(a){var b=0;return $jscomp.iteratorPrototype(function(){return b<a.length?{done:!1,value:a[b++]}:{done:!0}})};
$jscomp.iteratorPrototype=function(a){$jscomp.initSymbolIterator();a={next:a};a[$jscomp.global.Symbol.iterator]=function(){return this};return a};$jscomp.makeIterator=function(a){$jscomp.initSymbolIterator();$jscomp.initSymbol();$jscomp.initSymbolIterator();var b=a[Symbol.iterator];return b?b.call(a):$jscomp.arrayIterator(a)};
$jscomp.polyfill=function(a,b,c,d){if(b){c=$jscomp.global;a=a.split(".");for(d=0;d<a.length-1;d++){var e=a[d];e in c||(c[e]={});c=c[e]}a=a[a.length-1];d=c[a];b=b(d);b!=d&&null!=b&&$jscomp.defineProperty(c,a,{configurable:!0,writable:!0,value:b})}};
$jscomp.polyfill("Array.from",function(a){return a?a:function(a,c,d){$jscomp.initSymbolIterator();c=null!=c?c:function(a){return a};var b=[],f=a[Symbol.iterator];if("function"==typeof f)for(a=f.call(a);!(f=a.next()).done;)b.push(c.call(d,f.value));else{f=a.length;for(var g=0;g<f;g++)b.push(c.call(d,a[g]))}return b}},"es6","es3");
$jscomp.iteratorFromArray=function(a,b){$jscomp.initSymbolIterator();a instanceof String&&(a+="");var c=0,d={next:function(){if(c<a.length){var e=c++;return{value:b(e,a[e]),done:!1}}d.next=function(){return{done:!0,value:void 0}};return d.next()}};d[Symbol.iterator]=function(){return d};return d};$jscomp.polyfill("Array.prototype.keys",function(a){return a?a:function(){return $jscomp.iteratorFromArray(this,function(a){return a})}},"es6","es3");
$jscomp.checkStringArgs=function(a,b,c){if(null==a)throw new TypeError("The 'this' value for String.prototype."+c+" must not be null or undefined");if(b instanceof RegExp)throw new TypeError("First argument to String.prototype."+c+" must not be a regular expression");return a+""};
$jscomp.polyfill("String.prototype.startsWith",function(a){return a?a:function(a,c){var b=$jscomp.checkStringArgs(this,a,"startsWith");a+="";var e=b.length,f=a.length;c=Math.max(0,Math.min(c|0,b.length));for(var g=0;g<f&&c<e;)if(b[c++]!=a[g++])return!1;return g>=f}},"es6","es3");$jscomp.polyfill("Object.is",function(a){return a?a:function(a,c){return a===c?0!==a||1/a===1/c:a!==a&&c!==c}},"es6","es3");
$jscomp.polyfill("Array.prototype.includes",function(a){return a?a:function(a,c){var b=this;b instanceof String&&(b=String(b));var e=b.length;for(c=c||0;c<e;c++)if(b[c]==a||Object.is(b[c],a))return!0;return!1}},"es7","es3");$jscomp.polyfill("String.prototype.includes",function(a){return a?a:function(a,c){return-1!==$jscomp.checkStringArgs(this,a,"includes").indexOf(a,c||0)}},"es6","es3");
$jscomp.polyfill("Array.prototype.entries",function(a){return a?a:function(){return $jscomp.iteratorFromArray(this,function(a,c){return[a,c]})}},"es6","es3");$jscomp.owns=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)};
$jscomp.polyfill("WeakMap",function(a){function b(a){$jscomp.owns(a,d)||$jscomp.defineProperty(a,d,{value:{}})}function c(a){var c=Object[a];c&&(Object[a]=function(a){b(a);return c(a)})}if(function(){if(!a||!Object.seal)return!1;try{var b=Object.seal({}),c=Object.seal({}),d=new a([[b,2],[c,3]]);if(2!=d.get(b)||3!=d.get(c))return!1;d.delete(b);d.set(c,4);return!d.has(b)&&4==d.get(c)}catch(h){return!1}}())return a;var d="$jscomp_hidden_"+Math.random().toString().substring(2);c("freeze");c("preventExtensions");
c("seal");var e=0,f=function(a){this.id_=(e+=Math.random()+1).toString();if(a){$jscomp.initSymbol();$jscomp.initSymbolIterator();a=$jscomp.makeIterator(a);for(var b;!(b=a.next()).done;)b=b.value,this.set(b[0],b[1])}};f.prototype.set=function(a,c){b(a);if(!$jscomp.owns(a,d))throw Error("WeakMap key fail: "+a);a[d][this.id_]=c;return this};f.prototype.get=function(a){return $jscomp.owns(a,d)?a[d][this.id_]:void 0};f.prototype.has=function(a){return $jscomp.owns(a,d)&&$jscomp.owns(a[d],this.id_)};f.prototype.delete=
function(a){return $jscomp.owns(a,d)&&$jscomp.owns(a[d],this.id_)?delete a[d][this.id_]:!1};return f},"es6","es3");$jscomp.MapEntry=function(){};
$jscomp.polyfill("Map",function(a){if(!$jscomp.ASSUME_NO_NATIVE_MAP&&function(){if(!a||!a.prototype.entries||"function"!=typeof Object.seal)return!1;try{var b=Object.seal({x:4}),c=new a($jscomp.makeIterator([[b,"s"]]));if("s"!=c.get(b)||1!=c.size||c.get({x:4})||c.set({x:4},"t")!=c||2!=c.size)return!1;var d=c.entries(),e=d.next();if(e.done||e.value[0]!=b||"s"!=e.value[1])return!1;e=d.next();return e.done||4!=e.value[0].x||"t"!=e.value[1]||!d.next().done?!1:!0}catch(k){return!1}}())return a;$jscomp.initSymbol();
$jscomp.initSymbolIterator();var b=new WeakMap,c=function(a){this.data_={};this.head_=f();this.size=0;if(a){a=$jscomp.makeIterator(a);for(var b;!(b=a.next()).done;)b=b.value,this.set(b[0],b[1])}};c.prototype.set=function(a,b){var c=d(this,a);c.list||(c.list=this.data_[c.id]=[]);c.entry?c.entry.value=b:(c.entry={next:this.head_,previous:this.head_.previous,head:this.head_,key:a,value:b},c.list.push(c.entry),this.head_.previous.next=c.entry,this.head_.previous=c.entry,this.size++);return this};c.prototype.delete=
function(a){a=d(this,a);return a.entry&&a.list?(a.list.splice(a.index,1),a.list.length||delete this.data_[a.id],a.entry.previous.next=a.entry.next,a.entry.next.previous=a.entry.previous,a.entry.head=null,this.size--,!0):!1};c.prototype.clear=function(){this.data_={};this.head_=this.head_.previous=f();this.size=0};c.prototype.has=function(a){return!!d(this,a).entry};c.prototype.get=function(a){return(a=d(this,a).entry)&&a.value};c.prototype.entries=function(){return e(this,function(a){return[a.key,
a.value]})};c.prototype.keys=function(){return e(this,function(a){return a.key})};c.prototype.values=function(){return e(this,function(a){return a.value})};c.prototype.forEach=function(a,b){for(var c=this.entries(),d;!(d=c.next()).done;)d=d.value,a.call(b,d[1],d[0],this)};c.prototype[Symbol.iterator]=c.prototype.entries;var d=function(a,c){var d=c&&typeof c;"object"==d||"function"==d?b.has(c)?d=b.get(c):(d=""+ ++g,b.set(c,d)):d="p_"+c;var e=a.data_[d];if(e&&$jscomp.owns(a.data_,d))for(a=0;a<e.length;a++){var f=
e[a];if(c!==c&&f.key!==f.key||c===f.key)return{id:d,list:e,index:a,entry:f}}return{id:d,list:e,index:-1,entry:void 0}},e=function(a,b){var c=a.head_;return $jscomp.iteratorPrototype(function(){if(c){for(;c.head!=a.head_;)c=c.previous;for(;c.next!=c.head;)return c=c.next,{done:!1,value:b(c)};c=null}return{done:!0,value:void 0}})},f=function(){var a={};return a.previous=a.next=a.head=a},g=0;return c},"es6","es3");
$jscomp.polyfill("Set",function(a){if(!$jscomp.ASSUME_NO_NATIVE_SET&&function(){if(!a||!a.prototype.entries||"function"!=typeof Object.seal)return!1;try{var b=Object.seal({x:4}),d=new a($jscomp.makeIterator([b]));if(!d.has(b)||1!=d.size||d.add(b)!=d||1!=d.size||d.add({x:4})!=d||2!=d.size)return!1;var e=d.entries(),f=e.next();if(f.done||f.value[0]!=b||f.value[1]!=b)return!1;f=e.next();return f.done||f.value[0]==b||4!=f.value[0].x||f.value[1]!=f.value[0]?!1:e.next().done}catch(g){return!1}}())return a;
$jscomp.initSymbol();$jscomp.initSymbolIterator();var b=function(a){this.map_=new Map;if(a){a=$jscomp.makeIterator(a);for(var b;!(b=a.next()).done;)this.add(b.value)}this.size=this.map_.size};b.prototype.add=function(a){this.map_.set(a,a);this.size=this.map_.size;return this};b.prototype.delete=function(a){a=this.map_.delete(a);this.size=this.map_.size;return a};b.prototype.clear=function(){this.map_.clear();this.size=0};b.prototype.has=function(a){return this.map_.has(a)};b.prototype.entries=function(){return this.map_.entries()};
b.prototype.values=function(){return this.map_.values()};b.prototype.keys=b.prototype.values;b.prototype[Symbol.iterator]=b.prototype.values;b.prototype.forEach=function(a,b){var c=this;this.map_.forEach(function(d){return a.call(b,d,d,c)})};return b},"es6","es3");$jscomp.polyfill("Array.prototype.values",function(a){return a?a:function(){return $jscomp.iteratorFromArray(this,function(a,c){return c})}},"es6","es3");
$jscomp.findInternal=function(a,b,c){a instanceof String&&(a=String(a));for(var d=a.length,e=0;e<d;e++){var f=a[e];if(b.call(c,f,e,a))return{i:e,v:f}}return{i:-1,v:void 0}};$jscomp.polyfill("Array.prototype.findIndex",function(a){return a?a:function(a,c){return $jscomp.findInternal(this,a,c).i}},"es6","es3");
$jscomp.polyfill("Object.assign",function(a){return a?a:function(a,c){for(var b=1;b<arguments.length;b++){var e=arguments[b];if(e)for(var f in e)$jscomp.owns(e,f)&&(a[f]=e[f])}return a}},"es6","es3");function clg(a){for(var b=[],c=0;c<arguments.length;++c)b[c-0]=arguments[c];console.log(Array.from(b).join(","))}window.clg=clg;function ast(a,b){console.assert(a,void 0===b?"anon":b)}window.ast=ast;function find(a,b){if(-1!==b.indexOf(a))return a}
function eko(a,b){console.log("eko <"+a+"> = "+b.toString());return b}function xor(a,b){return a?!b:b}window.xor=xor;function uuidv4(){return"10000000-1000-4000-8000-100000000000".replace(/[018]/g,function(a){return(a^window.crypto.getRandomValues(new Uint8Array(1))[0]&15>>a/4).toString(16)})}window.uuidv4=uuidv4;
function localStorageLoad(a){var b=Object.keys(window.localStorage||{}),c=[],d=b.length;for(clg("lsl sees keys"+b);d--;)b[d].startsWith(a)&&c.push(JSON.parse(window.localStorage.getItem(b[d])||""));return c}function isString(a){return"string"===typeof a}Storage.prototype.setObject=function(a,b){this.setItem(a,JSON.stringify(b))};Storage.prototype.getObject=function(a){return(a=this.getItem(a))&&JSON.parse(a)};var MISSING={},QUEUE_COMPACT_SIZE=500;
function define(a,b){for(var c in b){var d=Object.getOwnPropertyDescriptor(b,c);d.enumerable=!1;Object.defineProperty(a,c,d)}}var ArrayQueue=function(){this._head=this.size=0;this._items=[]};ArrayQueue.prototype.emptyp=function(){return 0===this.size};ArrayQueue.prototype.push=function(a){this._items.push(a);return++this.size};
ArrayQueue.prototype.shift=function(){if(this.size){var a=this._items[this._head];this._head===QUEUE_COMPACT_SIZE?(this._items=this._items.slice(this._head+1),this._head=0,this.size--):this._items[this._head++]=MISSING;return a}};ArrayQueue.prototype.clear=function(){this._head=this.size=0;this._items.length=0};ArrayQueue.prototype.forEach=function(a,b){if(this.size)for(var c=this._head,d=0;c<this._items.length;c++){var e=this._items[c];e!==MISSING&&a.call(b,e,d++,this)}};
var Stack=function(){var a=function(){var a=[];return[function(){return a.push.apply(a,arguments)},function(){return a.pop.apply(a,arguments)},function(){return a.length},function(b){return a.length=b},function(){return a[a.length-1]},function(b){return a.includes(b)},function(){return a}]}();this.push=a[0];this.pop=a[1];this.getLength=a[2];this.setLength=a[3];this.peek=a[4];this.includes=a[5];this.elts=a[6];this.push.apply(this,arguments)};
Array.prototype.somex=function(a){for(var b=$jscomp.makeIterator(this.entries()),c=b.next();!c.done;c=b.next()){var d=$jscomp.makeIterator(c.value);c=d.next().value;d=d.next().value;if(c=a(c,d))return c}return null};var causation=new Stack,callStack=new Stack,depender=null,gNotToBe=!1,gCPropDepth=0,gCDebug=!1,gStop=!1,ppulse=0;function gpulse(){return ppulse}var gPar=null,onePulsep=!1,dpLogp=!1;
function dataPulseNext(a){onePulsep||(dpLogp&&clg("dpnext "+(void 0===a?"anon":a)),ppulse+=1);return ppulse}function cellsReset(a){a=void 0===a?{}:a;gCDebug=a.debug;clientQHandler=a.clientQHandler;cellsInit()}function cellsInit(){ppulse=0}var deferChanges=!1,clientQHandler=null,gCustomPropagator=null,gWithinIntegrity=!1,gSlotObserver={};function gSlotObserverDef(a,b){gSlotObserver[a]&&clg("gSlotObserverDef overwriting $(slot) observer");gSlotObserver[a]=b}var qNotify=new ArrayQueue,qAwaken=new ArrayQueue;
window.qAwaken=qAwaken;var qClient=new ArrayQueue,qEphemReset=new ArrayQueue,qChange=new ArrayQueue;function ufbAdd(a,b){a.push(b)}function withoutCDependency(a){return function(b){var c=depender;depender=null;try{return a(b)}finally{depender=c}}}function withoutIntegrity(a){var b=gWithinIntegrity,c=deferChanges;try{deferChanges=gWithinIntegrity=!1,a()}finally{gWithinIntegrity=b,deferChanges=c}}
function withIntegrity(a,b,c){if(!gStop)if(gWithinIntegrity){if(a)return ufbAdd(a,[b,c]),"deferred-to-ufb";c(a,b)}else{var d=gWithinIntegrity,e=deferChanges;gWithinIntegrity=!0;deferChanges=!1;try{gpulse()&&a!==qChange||dataPulseNext("cwi");var f=c(a,b);finBiz(qNotify);return f}finally{gWithinIntegrity=d,deferChanges=e}}}window.withIntegrity=withIntegrity;function withChg(a,b){withIntegrity(qChange,a,b)}window.withChg=withChg;
function finBiz(a){for(;a;)switch(a){case qNotify:qDo("notify",a);qDo("awaken",qAwaken);a=qNotify.emptyp()?qClient:qNotify;break;case qClient:(clientQHandler||qDo)("client",a);a=qClient.emptyp()?qEphemReset:qClient;break;case qEphemReset:qDo("reset empheral",a);a=qChange;break;case qChange:if(a=a.shift()){var b=$jscomp.makeIterator(a);a=b.next().value;b=b.next().value;dataPulseNext("change");b("change",a);a=qNotify}else a=null;break;default:throw"finBiz sees invalid q: "+a.toString();}}
function qDo(a,b){b.forEach(function(b){var c=$jscomp.makeIterator(b);b=c.next().value;c=c.next().value;c(a,b)});b.clear()}$jscomp.initSymbol();
var kUnbound=Symbol("unbound"),kUncurrent="uncurrent",kValid="valid",kAwake="c-awake",kQuiesced="c-quiesced",kNascent="nascent",kOptimizedAwayp="optimized-away",kOptimizeWhenValued="optimize-when-valued",kOnceAsked="lazy-once-asked",kUntilAsked="lazy-until-asked",kAlways="lazy-always",kObserverUnresolved="kObserverUnresolved",Cell=function(a,b,c,d,e,f,g){g=void 0===g?!c:g;this.name=void 0===f?"anon":f;this.md=null;this.pulseObserved=this.pulseLastChanged=this.pulse=-1;this.lazy=null;this.callers=
new Set;this.useds=new Set;this.ephemeralp=d;this.inputp=c;this.observer=e;this.optimize=g;this.synapticp=this.slotOwning=!1;b?(this.rule=b,this.pv=kUnbound,this.state=kNascent,this.others={}):(this.pv=a,this.state=kValid);Object.defineProperty(this,"v",{enumerable:!0,get:this.slotValue,set:this.slotValueSet})};Cell.prototype.mx=function(){return this.md};Cell.prototype.optimizedAwayp=function(){return this.state===kOptimizedAwayp};Cell.prototype.unboundp=function(){return this.pv===kUnbound};
Cell.prototype.uncurrentp=function(){return this.pv===kUncurrent};Cell.prototype.validp=function(){return!(this.unboundp()||this.uncurrentp())};Cell.prototype.valueState=function(){return this.unboundp()?kUnbound:this.uncurrentp()?kUncurrent:kValid};Cell.prototype.valueChangedp=function(a,b){return a!==b};Cell.prototype.currentp=function(){return this.pulse>=gpulse()};Cell.prototype.pulseUpdate=function(a){this.optimizedAwayp()||(ast(gpulse()>=this.pulse),this.pulse=gpulse())};
Cell.prototype.awaken=function(){this.rule?this.currentp()||this.calcNSet("c-awaken"):gpulse()>this.pulseObserved&&(this.observe(kUnbound,"awaken"),this.ephemeralReset())};Cell.prototype.slotValue=function(){var a=void 0,b=this;withIntegrity(null,null,function(){var c=b.pv;a=b.ensureValueIsCurrent("c-read",null);!b.md&&b.state===kNascent&&gpulse()>b.pulseObserved&&(b.state=kAwake,b.observe(c,"cget"),b.ephemeralReset())});depender&&depender.recordDependency(this);return a};
Cell.prototype.slotValueSet=function(a){var b=this;if(deferChanges)throw"Assign to "+this.name+" must be deferred by wrapping it in WITH-INTEGRITY";find(this.lazy,[kOnceAsked,kAlways,!0])?this.valueAssume(a,null):withChg(this.name,function(){b.valueAssume(a,null)})};Cell.prototype.recordDependency=function(a){a.optimizedAwayp()||(this.useds.add(a),ast(0<this.useds.size),a.callerEnsure(this))};Cell.prototype.callerEnsure=function(a){this.callers.add(a)};Cell.prototype.callerDrop=function(a){this.callers.delete(a)};
Cell.prototype.ensureValueIsCurrent=function(a,b){if(gNotToBe)return this.validp()?this.pv:null;if(this.currentp())return this.pv;if(!this.inputp||!this.validp()||this.rule&&this.optimize===kOptimizeWhenValued&&null===this.pv){if(this.md&&this.md.mDeadp())throw"evic: read of dead "+this.name+" of "+this.md.name;a=!1;if(this.validp())for(var c=$jscomp.makeIterator(this.useds.values()),d=c.next();!d.done;d=c.next()){if(d=d.value,d.ensureValueIsCurrent("nested",this),d.pulseLastChanged>this.pulse){a=
!0;break}}else a=!0;a?this.currentp()||this.calcNSet("evic",b):this.pulseUpdate("valid-uninfluence")}return this.pv};Cell.prototype.calcNSet=function(a,b){if(callStack.includes(this))throw callStack.elts(),clg("cyclic dependency: about to calculate "+this.name+" already calculating"),"cyclic dependency detected. see console for deets";a=this.calcNLink();if(!this.optimizedAwayp())return this.valueAssume(a,null)};
Cell.prototype.calcNLink=function(){var a=depender,b=deferChanges;depender=this;deferChanges=!0;try{return callStack.push(this),this.unlinkFromUsed("pre-rule-clear"),this.rule(this)}finally{callStack.pop(),depender=a,deferChanges=b}};
Cell.prototype.valueAssume=function(a,b){var c=this,d=this;withoutCDependency(function(){var e=d.pv,f=d.valueState();d.pv=a;d.state=kAwake;d.md&&!d.synapticp&&mdSlotValueStore(d.md,d.name,a);d.pulseUpdate("sv-assume");if("propagate"===b||-1===[kValid,kUncurrent].indexOf(f)||d.valueChangedp(a,e))f=d.rule?d.optimize:null,f===kOptimizeWhenValued?d.pv&&(d.unlinkFromUsed("opti-when"),c.optimizeAwayMaybe(e)):f&&d.optimizeAwayMaybe(e),"no-propagate"===b||d.optimizedAwayp()||d.propagate(e,d.callers)})();
return a};Cell.prototype.propagate=function(a,b){if(onePulsep)gCustomPropagator&&gCustomPropagator(this,a);else{this.pulseLastChanged=gpulse();var c=depender,d=callStack,e=gCPropDepth,f=deferChanges;try{this.propagateToCallers(b),(gpulse()>this.pulseObserved||find(this.lazy,[kOnceAsked,kAlways,!0]))&&this.observe(a,"propagate"),this.ephemeralReset()}finally{depender=c,callStack=d,gCPropDepth=e,deferChanges=f}}};
Cell.prototype.propagateToCallers=function(a){if(a.size){var b=this;withIntegrity(qNotify,b,function(){causation.push(b);try{for(var c=$jscomp.makeIterator(a.values()),d=c.next();!d.done;d=c.next()){var e=d.value;e.state===kQuiesced||e.currentp()||find(e.lazy,[!0,kAlways,kOnceAsked])||!e.useds.has(b)||e.calcNSet("propagate")}}finally{causation.pop()}})}};
Cell.prototype.observerResolve=function(){!this.observer&&this.md&&(this.observer=this.md.slotObserverResolve(this.name));return this.observer===kObserverUnresolved?null:this.observer};Cell.prototype.observe=function(a,b){(b=this.observerResolve())&&b(this.name,this.md,this.pv,a,this)};Cell.prototype.ephemeralReset=function(){if(this.ephemeralp){var a=this;withIntegrity(qEphemReset,this,function(){a.pv=null})}};
Cell.prototype.unlinkFromUsed=function(a){a=$jscomp.makeIterator(this.useds.values());for(var b=a.next();!b.done;b=a.next())b.value.callerDrop(this);this.useds.clear()};Cell.prototype.mdCellFlush=function(){};
Cell.prototype.optimizeAwayMaybe=function(a){if(this.rule&&!this.useds.size&&this.optimize&&!this.optimizedAwayp()&&this.validp()&&!this.synapticp&&!this.inputp){this.state=kOptimizedAwayp;this.observe(a,"optimized-away");this.md&&this.mdCellFlush();a=$jscomp.makeIterator(this.callers.values());for(var b=a.next();!b.done;b=a.next())b=b.value,this.callerDrop(b),b.ensureValueIsCurrent("opti-used",this)}};Cell.prototype.quiesce=function(){this.unlinkFromCallers();this.unlinkFromUsed("quiesce")};
Cell.prototype.unlinkFromCallers=function(){this.state=kUncurrent;for(var a=$jscomp.makeIterator(this.callers.values()),b=a.next();!b.done;b=a.next())this.callerDrop(b.value);this.callers.clear()};Cell.prototype.kidValuesKids=function(){var a=this,b=a.md,c=a.pv===kUnbound?[]:a.pv;return b.kidValues.map(function(d){var e=c.findIndex(function(b){return a.md.kidKey(b)===d});return-1===e?b.kidFactory(a,d):c[e]})};
Cell.prototype.fm=function(a,b,c){if(a){if(!this.md)throw"Family search attempted from Cell "+this+" lacking md (s/b a Model)";return this.md.fm(a,b,c)}};Cell.prototype.fmUp=function(a,b,c){if(!this.md)throw"fmUp search attempted from Cell "+this+" lacking md (s/b a Model)";return this.md.fmUp(a,b,c)};Cell.prototype.fmDown=function(a,b,c){if(!this.md)throw"fmDown search attempted from Cell "+this+" lacking md (s/b a Model)";return this.md.fmDown(a,c,b)};window.Cell=Cell;Cell.prototype.mx=Cell.prototype.mx;
function mdSlotValueStore(a,b,c){}function cF(a,b){return Object.assign(new Cell(null,a,!1,!1,null),b)}window.cF=cF;function cF1(a,b){return Object.assign(new Cell(null,function(b){return withoutCDependency(a)(b)},!1,!1,null),b)}function cF_(a,b){return Object.assign(new Cell(null,a,!1,!1,null),{lazy:!0},b)}function c_F(a,b){return Object.assign(new Cell(null,a,!1,!1,null),{lazy:kUntilAsked},b)}function cFI(a,b){return Object.assign(new Cell(null,a,!0,!1,null),b)}window.cFI=cFI;
function cI(a,b){return Object.assign(new Cell(a,null,!0,!1,null),b)}window.cI=cI;function cIe(a,b){return Object.assign(new Cell(a,null,!0,!0,null),b)}function obsDbg(a,b,c,d,e){console.log("obsDbg! "+a+" "+(b?b.name||b.id:"noMd")+" new="+c+" prior="+(d===kUnbound?"unbound":d))}function XobsDbg(a,b,c,d,e){};function allArgs(a){return Array.apply(null,a).slice(0)}window.allArgs=allArgs;function cdrArgs(a){return Array.apply(null,a).slice(1)}window.cdrArgs=cdrArgs;function cddrArgs(a){return Array.apply(null,a).slice(2)}window.cddrArgs=cddrArgs;var kAwakening="md-awakening",kDoomed="md-doomed",kDead="md-dead",sid=0;window.sid=sid;
var Model=function(a,b,c,d){var e=this;d=void 0===d?!0:d;this.par=a||gPar;this.sid=++sid;this.name=b;this.kids=this.mdType=null;this.cells={};this.slotObservers=[];this.others={};this.state=kNascent;this.awakenOnInitp=this.doomed=!1;this.adoptCt=0;a={};for(var f in c)a.slot=f,c.hasOwnProperty(a.slot)?(a.value=c[a.slot],a.value instanceof Cell?(a.value.name=a.slot,a.value.md=this,this.cells[a.slot]=a.value,Object.defineProperty(this,a.slot,{enumerable:!0,get:function(a){return function(){return a.value.slotValue()}}(a),
set:function(a){return function(b){return a.value.slotValueSet(b)}}(a)})):Object.defineProperty(this,a.slot,{enumerable:!0,get:function(a){return function(){return a.value}}(a),set:function(a){return function(c){debugger;throw"Slot "+a.slot+" of "+b+" cannot be set to "+c+" because it is not mediated by an input Cell";}}(a)}),a={value:a.value,slot:a.slot}):clg("DBG: yep, islot not hasown ",a.slot);d&&(this.awakenOnInitp?this.awaken():withIntegrity(qAwaken,this,function(a){e.awaken()}))};
Model.cname=function(){return"Model"};Model.prototype.dbg=function(){return"MD "+this.mdType+":"+(this.name||this.sid)};Model.prototype.awaken=function(){if(this.state!==kNascent)return this;this.state=kAwakening;for(var a in this.cells){var b=this.cells[a];console.assert(b.md,"No md for cell "+b.name+" at md awaken");find(b.lazy,[!0,kAlways,kUntilAsked])||b.awaken()}this.state=kAwake};Model.prototype.slotObserverResolve=function(a){return null};
Model.prototype.fmd=function(a,b,c){return this.fm(a,Object.assign({mep:!1,upp:!1,insidep:!0},c),b)};Model.prototype.fm=function(a,b,c){var d=null;if(c){var e=this.others[c];if(e)return e}b=Object.assign({mep:!1,mustp:!0,insidep:!1,upp:!0,wocd:!0},b);e=depender;depender=b.wocd?null:depender;try{var f=this.fmTv(a,b);if(f)d=this.others[c]=f;else if(b.mustp)throw"fget failed what = "+a.toString()+", id "+this.id+", where = "+this.name;}finally{depender=e}return d};
Model.prototype.fmUp=function(a,b,c){return this.fm(a,Object.assign({upp:!0,mep:!1},b),c)};Model.prototype.fmDown=function(a,b,c){return this.fm(a,Object.assign({upp:!1,insidep:!0,mep:!1},b),c)};Model.prototype.fmatch=function(a){return"function"===typeof a&&a(this)||"string"===typeof a&&this.name===a||this===a?this:null};
Model.prototype.fmTv=function(a,b){return b.mep&&this.fmatch(a)||b.insidep&&this.kids&&this.kids.somex(function(c,d){if(c=d!==b.skip&&d.fmTv(a,Object.assign({},b,{upp:!1,mep:!0})))return c})||b.upp&&this.par&&this.par.fmTv(a,Object.assign({},b,{mep:!0,insidep:!0,skip:this}))};Model.prototype.mDeadp=function(){return this.state===kDead};window.Model=Model;Model.prototype.awaken=Model.prototype.awaken;var isModel=function(a){return a instanceof Model};
function mkm(a,b,c,d,e){e=void 0===e?"Model":e;c=Object.assign({},c,d?{kids:cKids(d)}:null);a=new window[e](a,b,c);if(!isModel(a))throw"mkm made not-modelp";return a}window.mkm=mkm;function pkdFlat(a,b){b=void 0===b?[]:b;for(var c=0;c<a.length;++c)null!=a[c]&&(a[c]instanceof Array?pkdFlat(a[c],b):b.push(a[c]));return b}
function cKids(a,b){b=void 0===b?{}:b;return Object.assign(new Cell(null,function(b){if(!isModel(b.md))throw"ckids c.md not model";b=kfExpand(b,a);return b instanceof Array?pkdFlat(b):[b]},!1,!1,null),b)}window.cKids=cKids;var kfExpandFinal=function(a){return null===a||isString(a)||isModel(a)||a instanceof Array&&a.every(kfExpandFinal)};
function kfExpand(a,b){if(kfExpandFinal(b))return b;if("function"===typeof b)return kfExpand(a,b(a));if(b instanceof Array)return kfExpand(a,b.map(function(b){return kfExpand(a,b)}));clg("expand bad kf",b,null===b,typeof b);debugger};
